/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see legal.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[5],{353:function(ia,da,h){function ca(e,h,n){h.endsWith("/")||(h+="/");n=n||{};var r=n.disableWebsockets||!1;this.MO=n.singleServerMode||!1;h.endsWith("blackbox/")||(h+="blackbox/");this.Ul=n.uploadData||null;this.cu=n.uriData||null;this.DI=n.cacheKey||null;this.Tf=Object(f.a)(h,null,r);this.Hf=h;this.mB=e;this.df=null;this.yh=ba();this.bl=ba();this.Yv=!1;this.Qf=this.Sd=this.he=this.Qe=null;this.mf=[];this.Dw=[];this.cache={};this.timeStamp=
0;this.Ef=[];this.Ig=[];this.DB=null;this.fB=!1;this.hE=this.id=null;this.gD=this.wL=ha;this.sy=0;this.zC=!1;this.V_=1;this.Hx={};this.cx=null;this.cq(!0)}function ba(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,kn:function(){return 1===(e.state&1)},d_:function(){return 2===(e.state&2)},uh:function(){return!e.d_()&&!e.kn()},PZ:function(){return 4===(e.state&4)},aO:function(){e.state|=4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===
e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function ha(){return!1}function ea(e,f,h){if(!(f in w))return!0;f=w[f];for(var n=0;n<f.length;n++){var r=e;var x=f[n];var y=h;if(x.name in r){var aa="",ba=!1;r=r[x.name];switch(x.type){case "s":aa="String";ba=Object(z.isString)(r);break;case "a":aa="Array";ba=Object(z.isArray)(r);break;case "n":aa="Number";ba=Object(z.isNumber)(r)&&Object(z.isFinite)(r);
break;case "o":aa="Object",ba=Object(z.isObject)(r)&&!Object(z.isArray)(r)}ba||y.reject('Expected response field "'+x.name+'" to have type '+aa);x=ba}else y.reject('Response missing field "'+x.name+'"'),x=!1;if(!x)return!1}return!0}h.r(da);var z=h(0);h.n(z);var x=h(1);ia=h(34);var r=h(26),f=h(370),aa=h(73),n=h(297),e=h(121),w={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},
{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};ca.prototype=Object(z.extend)(ca.prototype,{dV:function(){var e=this;return new Promise(function(f,h){var n=new XMLHttpRequest;n.open("GET",e.Hf+"ck");n.withCredentials=e.Ym();n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?
f():h())};n.send()})},v2:function(e,f){this.wL=e||ha;this.gD=f||ha},TI:function(){var e=this;this.bl=ba();this.yh=ba();return this.Tf.wB().then(function(){e.Yv=!1;e.id=null;e.fB=!1;return e.dV()})},VD:function(){this.wL();this.px();this.Qe&&(this.Qe.uh()?this.ef(this.Qe.request):this.Qe.kn()&&this.gD(this.Qe.result.url,"pdf")&&(this.Qe=null,this.wN()));this.Qf&&this.Qf.uh()&&this.ef(this.Qf.request);this.he&&this.he.uh()?this.ef(this.he.request):this.Sd&&this.Sd.uh()&&this.kL(this.Sd.request);var e;
for(e=0;e<this.Ef.length;e++)this.Ef[e]&&this.Ef[e]&&(this.Ef[e].uh()?this.ef(this.Ef[e].request):this.Ef[e].kn()&&this.gD(this.Ef[e].result.url,"image")&&(this.Ef[e]=null,this.py(e)));for(e=0;e<this.Ig.length;e++)this.Ig[e]&&this.Ig[e]&&this.Ig[e].uh()&&!this.Ig[e].PZ()&&this.ef(this.Ig[e].request);for(e=0;e<this.mf.length;e++)this.mf[e]&&this.mf[e].uh()&&this.ef(this.mf[e].request)},px:function(f){var h=this;this.Yv||(this.timeStamp=Date.now(),this.Tf.NE(function(e){h.g0(e)}).then(function(){clearInterval(h.jy);
h.jy=null},function(n){h.Yv=!1;if(!h.jy){var r=0;h.fB=!0;h.hE=0;h.jy=setInterval(function(){2>r++?h.VD():(clearInterval(h.jy),f&&f.reject(e.a),Object(x.e)("Blackbox connection failed:"+n))},5E3)}}),this.Yv=!0)},F4:function(){var e=this,f=createPromiseCapability();if(this.Ul){var h=new FormData;h.append("file",this.Ul.fileHandle,this.Ul.fileHandle.name);var n=this.Ul.loadCallback;var w="upload";var x=this.Ul.extension}else if(this.cu){h={uri:this.cu.uri,F7:this.cu.shareId};h=Object.keys(h).map(function(e){return e+
"="+(h[e]?encodeURIComponent(h[e]):"")}).join("&");var z="application/x-www-form-urlencoded; charset=UTF-8";n=this.cu.loadCallback;w="url";x=this.cu.extension}else return Promise.resolve();var aa=new XMLHttpRequest;aa.open("POST",Object(r.i)(e.Hf,"AuxUpload?ext="+x+"&type="+w+"&bcid="+this.Tf.clientId));aa.withCredentials=this.Ym();z&&aa.setRequestHeader("Content-Type",z);aa.addEventListener("load",function(){if(aa.readyState===aa.DONE&&200===aa.status){var h=JSON.parse(aa.response);e.mB=h.uri;n(h);
f.resolve(h)}});aa.addEventListener("error",function(){f.reject(aa.statusText+" "+JSON.stringify(aa))});this.Ul&&null!=this.Ul.onProgress&&(aa.upload.onprogress=function(f){e.Ul.onProgress(f)});aa.send(h);return f.promise},N2:function(e){this.cx=e},RY:function(e){this.password&&this.yh.kn()?e(this.password):this.cx(e)},j1:function(e){this.password=e||null;this.yh.kn()||(this.px(this.yh),this.ef({t:"pages"}));return this.yh.promise},Dt:function(e){this.DB=e||null;this.yh.kn()||(this.px(this.yh),this.ef({t:"pages"}));
return this.yh.promise},VI:function(e){e=Object.assign(e,{uri:encodeURIComponent(this.mB)});this.DB&&(e.ext=this.DB);this.df&&(e.c=this.df);this.password&&(e.pswd=this.password);this.DI&&(e.cacheKey=this.DI);return e},ef:function(e){e=this.VI(e);this.Tf.send(e)},Cj:function(e){return e},g0:function(e){var f=this,h=e.data,n=e.err,r=e.t;if(n&&f.cx&&"This document could not be decrypted with the given password"===n)f.cx(function(e){f.j1(e)});else switch(r){case "upload":n?f.G4.reject(n):f.G4.resolve("Success");
break;case "pages":n?f.yh.reject(n):ea(h,r,f.yh)&&f.yh.resolve(h);break;case "config":n?f.bl.reject(n):ea(h,r,f.bl)&&(h.id&&(f.id=h.id),h.serverVersion&&(f.U4=h.serverVersion,Object(x.f)("[WebViewer Server] server version: "+f.U4)),h.serverID?(f.sy=h.serverID===f.hE&&f.zC?f.sy+1:0,f.hE=h.serverID):f.sy=0,f.zC=!1,f.bl.resolve(h));break;case "health":n?f.bl.reject(n):ea(h,r,f.bl)&&(h=h.unhealthy,f.MO&&h?Object(x.h)("Server failed health check. Single server mode ignoring check."):!f.k6&&h&&1>=f.sy&&
(f.zC=!0,f.TI().then(function(){f.VD()},function(){f.VD()})));break;case "pdf":h.url=f.Hf+"../"+encodeURI(h.url)+"?bcid="+this.Tf.clientId;n?f.Qe.reject(n):ea(h,r,f.Qe)&&f.Qe.resolve(h);break;case "docmod":h.url=f.Hf+"../"+encodeURI(h.url)+"?bcid="+this.Tf.clientId;n?f.Hx[h.rID].reject(n):ea(h,r,f.Qe)&&f.Hx[h.rID].resolve(h);break;case "xod":if(n)this.he&&this.he.uh()&&this.he.reject(n),this.Sd&&this.Sd.uh()&&this.Sd.reject(n);else if(h.notFound)h.noCreate||this.he&&this.he.uh()&&this.he.resolve(h),
this.Sd&&this.Sd.uh()&&this.Sd.resolve(h);else{h.url&&(h.url=f.Hf+"../"+encodeURI(h.url)+"?bcid="+this.Tf.clientId);if(!this.Sd||this.Sd.kn())this.Sd=ba(),this.Sd.request={t:"xod",noCreate:!0};this.he||(this.he=ba(),this.he.request={t:"xod"});this.Sd.resolve(h);this.he.resolve(h)}break;case "annots":if(n)f.Qf.reject(n);else if(ea(h,r,f.Qf)){f.Qf.aO();var w=new XMLHttpRequest;e=f.Hf+"../"+encodeURI(h.url);var y=h.hasAppearance?e+".xodapp?bcid="+this.Tf.clientId:null;e+="?bcid="+this.Tf.clientId;w.open("GET",
e);w.responseType="text";w.withCredentials=this.Ym();w.addEventListener("load",function(){w.readyState===w.DONE&&200===w.status&&f.Qf.resolve({fF:w.response,qI:y})});w.addEventListener("error",function(){f.Qf.reject(w.statusText+" "+JSON.stringify(w))});w.send()}break;case "image":var z=this.Ef[h.p];n?z.promise.reject(n):ea(h,r,z)&&(z.result=h,z.result.url=f.Hf+"../"+encodeURI(z.result.url)+"?bcid="+this.Tf.clientId,z.resolve(z.result));break;case "tiles":z=h.rID;e=this.mf[z];this.mf[z]=null;this.Dw.push(z);
if(n)e.reject(n);else if(ea(h,r,e)){for(n=0;n<h.tiles.length;n++)h.tiles[n]=f.Hf+"../"+encodeURI(h.tiles[n])+"?bcid="+this.Tf.clientId;e.resolve(h)}break;case "text":z=this.Ig[h.p];if(n)z.reject(n);else if(ea(h,r,z)){z.aO();var ca=new XMLHttpRequest;ca.open("GET",f.Hf+"../"+encodeURI(h.url)+"?bcid="+this.Tf.clientId);ca.withCredentials=this.Ym();ca.addEventListener("load",function(){ca.readyState===ca.DONE&&200===ca.status&&(z.result=JSON.parse(ca.response),z.resolve(z.result))});ca.addEventListener("error",
function(e){z.reject(ca.statusText+" "+JSON.stringify(e))});ca.send()}break;case "progress":"loading"===h.t&&f.trigger(aa.a.Events.DOCUMENT_LOADING_PROGRESS,[h.bytes,h.total])}},nK:function(){this.px(this.bl);return this.bl.promise},eX:function(){this.Qf||(this.Qf=ba(),this.Qf.request={t:"annots"},this.ef(this.Qf.request));return this.Qf.promise},py:function(e){this.Ef[e]||(this.Ef[e]=ba(),this.Ef[e].request={t:"image",p:e},this.ef(this.Ef[e].request));return this.Ef[e].promise},k1:function(e){this.Ig[e]||
(this.Ig[e]=ba(),this.Ig[e].request={t:"text",p:e},this.ef(this.Ig[e].request));return this.Ig[e].promise},l1:function(e,f,h,n){var r=this.mf.length;this.Dw.length&&(r=this.Dw.pop());this.mf[r]=ba();this.mf[r].request={t:"tiles",p:e,z:f,r:h,size:n,rID:r};this.ef(this.mf[r].request);return this.mf[r].promise},wN:function(){this.Qe||(this.Qe=ba(),this.Qe.request={t:"pdf"},this.fB?this.Qe.resolve({url:this.mB}):this.ef(this.Qe.request));return this.Qe.promise},FK:function(e){var f=this,h=new XMLHttpRequest,
n=this.Hf+"aul?id="+this.id+"&bcid="+this.Tf.clientId,r=new FormData,w={};e.annots&&(w.annots="xfdf");e.watermark&&(w.watermark="png");e.redactions&&(w.redactions="redact");w={t:"docmod",reqID:this.V_++,parts:w};e.print&&(w.print=!0);var x=this.VI(w);r.append("msg",JSON.stringify(x));return Promise.all([e.annots,e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var w=e[0],y=e[1],z=e[2];w&&r.append("annots",w);y&&r.append("watermark",e.watermark);z&&r.append("redactions",
z);f.Hx[x.reqID]=ba();h.open("POST",n);h.withCredentials=f.Ym;h.send(r);return f.Hx[x.reqID].promise})},kL:function(){this.Sd||(this.Sd=ba(),this.Sd.request={t:"xod",noCreate:!0},this.ef(this.Sd.request));return this.Sd.promise},m1:function(){this.he||(this.he=ba(),this.he.request={t:"xod"},this.ef(this.he.request));return this.he.promise},Hl:function(){return!0},request:function(){},fN:function(){},abort:function(){for(var e=0;e<this.mf.length;e++)this.mf[e]&&(this.mf[e].resolve(null),this.mf[e]=
null,this.Dw.push(e));this.close()},By:function(e){this.df=this.df||{};this.df.headers=e},G6:function(){return this.df?Object(z.omit)(this.df.headers,["Cookie","cookie"]):null},cq:function(e){this.df=this.df||{};this.df.internal=this.df.internal||{};this.df.internal.withCredentials=e},Ym:function(){return this.df&&this.df.internal?this.df.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(ia.b)(ca);Object(n.a)(ca);Object(n.b)(ca);da["default"]=ca},370:function(ia,
da,h){function ca(h){for(var z="",x=0;x<h;x++)z+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return z}function ba(h,z,x){function r(f,e,h){function n(e){w().then(function(f){da&&!ea?setTimeout(function(){n(e)},1):f.send(JSON.stringify(e))})}function r(e,f,r){var w=window.createPromiseCapability(),y=!1,fa=w;aa=e;ba=f;ca=r;z=null;try{e=ha?ia+"/"+ha:ia+"/ws";e+="?bcid="+h;var ja=new WebSocket(e);ja.onopen=function(){w.resolve();y=!0;w=null;da=
!1;x.resolve(ja);ba&&ba()};ja.onerror=function(e){da=ea=!0;w&&w.reject(e);z&&z.reject()};ja.onclose=function(){x=window.createPromiseCapability();da=!0;z||(z=window.createPromiseCapability());z.resolve();ca&&ca();aa&&y&&aa({t:"health",data:{unhealthy:!0,isDead:!0}})};ja.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?n({hb:!0}):e.end?close():aa(e))}}catch(Ca){w.reject(Ca),w=null}return fa.promise}function w(){da&&aa&&r(aa);return x.promise}var x=window.createPromiseCapability(),z=null,
aa,ba,ca=null,da=!1,ea=!1,ha=e,ia=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);return h+e.slice(f,n)}(f);return{send:n,NE:r,wB:function(){return z?z.promise:w().then(function(e){z=window.createPromiseCapability();aa=null;e.close();return z.promise})},clientId:h}}function f(f){var e=f.lastIndexOf("/");0>e&&(e=f.length);return f.slice(0,e)}var aa=ca(8);return window.WebSocket&&!x?r(h,z,aa):function(h,e,r){function n(e){(da?
da.promise:Promise.resolve(ca)).then(function(f){var h=new XMLHttpRequest;f=ba?aa+"/"+ba+"pf?id="+f:aa+"/pf?id="+f;f+="&bcid="+r;var n=new FormData;n.append("data",JSON.stringify(e));h.open("POST",f);h.withCredentials=!0;h.send(n)})}function w(){ca=0;da||(da=window.createPromiseCapability())}function x(){z=new XMLHttpRequest;var e=aa+"/pf";e=0!==ca?e+("?id="+ca+"&uc="+ta):e+("?uc="+ta);ta++;z.open("GET",e,!0);z.withCredentials=!0;z.setRequestHeader("Cache-Control","no-cache");z.setRequestHeader("X-Requested-With",
"XMLHttpRequest");var f=z,h=!1;z.onreadystatechange=function(){a:if(3<=f.readyState&&!h){try{var e=f.responseText.length}catch(ya){Object(ha.f)("caught exception");break a}if(0<e)try{var r=f.responseText.split("\n");for(r[r.length-1]&&r.pop();0<r.length&&3>r[r.length-1].length;)"]"===r.pop()&&w();0<r.length&&3>r[0].length&&r.shift();for(e=0;e<r.length;++e)r[e].endsWith(",")&&(r[e]=r[e].substr(0,r[e].length-1));0===ca&&0<r.length&&(ca=JSON.parse(r.shift()).id,e=da,da=null,e.resolve(ca));var y;for(e=
0;e<r.length;++e)(y=JSON.parse(r[e]))&&y.end?close():y&&y.hb&&y.id===ca?n({hb:!0}):za(y)}catch(ya){}ea||(h=!0,x())}};z.send()}var z,aa=f(h),ba=e,ca=0,da=window.createPromiseCapability(),ea=!1,ia=null,za=null,ta=0;return{send:n,NE:function(e,f,h){za=e;ia=h;ea=!1;w();x();f&&f();return Promise.resolve()},wB:function(){w();za=null;ea=!0;ia&&ia();z.abort();return Promise.resolve()},clientId:r}}(h,z,aa)}h.d(da,"a",function(){return ba});var ha=h(1)}}]);}).call(this || window)
